generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model acesso {
  id             Int          @id @default(autoincrement())
  visitante_id   Int
  sala_id        Int?
  agendamento_id Int?
  entrada_em     DateTime?    @db.Timestamp(6)
  saida_em       DateTime?    @db.Timestamp(6)
  ativo          Boolean?     @default(true)
  criado_em      DateTime?    @default(now()) @db.Timestamp(6)
  agendamento    agendamento? @relation(fields: [agendamento_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  sala           sala?        @relation(fields: [sala_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  visitante      visitante    @relation(fields: [visitante_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model agendamento {
  id            Int       @id @default(autoincrement())
  visitante_id  Int
  sala_id       Int?
  data_agendada DateTime  @unique(map: "idx_agendamento_data") @db.Timestamp(6)
  status        Int?      @default(1) @db.SmallInt
  ativo         Boolean?  @default(true)
  criado_em     DateTime? @default(now()) @db.Timestamp(6)
  acesso        acesso[]
  sala          sala?     @relation(fields: [sala_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  visitante     visitante @relation(fields: [visitante_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model feriado {
  id        Int       @id @default(autoincrement())
  data      DateTime  @unique(map: "idx_feriado_data") @db.Date
  descricao String
  tipo      Int?      @db.SmallInt
  ativo     Boolean?  @default(true)
  criado_em DateTime? @default(now()) @db.Timestamp(6)
}

/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model sala {
  id                  Int                @id @default(autoincrement())
  nome                String             @db.VarChar(100)
  disponibilidade     Json
  capacidade          Int
  variacao_capacidade Int?               @default(2) @db.SmallInt
  ativo               Boolean?           @default(true)
  criado_em           DateTime?          @default(now()) @db.Timestamp(6)
  acesso              acesso[]
  agendamento         agendamento[]
  sala_responsavel    sala_responsavel[]
}

model sala_responsavel {
  id         Int       @id @default(autoincrement())
  sala_id    Int?
  nome       String
  valido_de  DateTime  @db.Date
  valido_ate DateTime? @db.Date
  ativo      Boolean?  @default(true)
  criado_em  DateTime? @default(now()) @db.Timestamp(6)
  sala       sala?     @relation(fields: [sala_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model tipo_prioridade {
  id               Int         @id @default(autoincrement())
  descricao        String      @db.VarChar(100)
  nivel_prioridade Int         @db.SmallInt
  ativo            Boolean?    @default(true)
  criado_em        DateTime?   @default(now()) @db.Timestamp(6)
  visitante        visitante[]
}

model visitante {
  id                 Int              @id @default(autoincrement())
  nome               String           @db.VarChar(100)
  documento          String           @unique(map: "idx_visitante_documento") @db.VarChar(50)
  data_nascimento    DateTime         @db.Date
  tipo_prioridade_id Int?
  foto               String?          @db.VarChar(255)
  ativo              Boolean?         @default(true)
  criado_em          DateTime?        @default(now()) @db.Timestamp(2)
  acesso             acesso[]
  agendamento        agendamento[]
  tipo_prioridade    tipo_prioridade? @relation(fields: [tipo_prioridade_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}
